name: Vue.js build and deploy

on:
  push:
    branches:
      - damien-exo

jobs:
  init:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v1
      with:
        node-version: 16.x
    - run:  echo "🔎 Le pipline commence ici !"
    # =======================
  a:
    needs: init
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v1
      with:
        node-version: 16.x
    - run: npm install
    - run: npm run test:unit
    # ==========================
  b:
    needs: init
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v1
      with:
        node-version: 16.x
    - run: npm install
    - run: npm run test:coverage
    # ========================
  c:
    needs: init
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v1
      with:
        node-version: 16.x
    - run: npm install
    - run: npm run test:coverage
    # ====================
  d:
    needs: init
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v1
      with:
        node-version: 16.x
    - run: npm install
    - run: npm run test:coverage
    # ===============
  e:
    needs: init
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v1
      with:
        node-version: 16.x
    - run: npm install
    - run: npm run lint
  # ===============
  f:
    needs: init
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v1
      with:
        node-version: 16.x
    - run: npm install
    - run: npm run lint
    # =========================
  g:
    needs: init
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v1
      with:
        node-version: 16.x
    - run: npm install
    - run: npm run lint
    # =========================
  build:
    needs: [init, a, b, c, d ,e, f ,g]
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v1
      with:
        node-version: 16.x
    - run: npm ci
    - run: npm run build
    # =========================
  deploy:
    needs: [init, a, b, c, d ,e, f, g, build, ]
    runs-on: ubuntu-latest
    steps:
    - run: echo "🔎 Deployement"
  fin:
    needs: [init,  a, b, c, d ,e, f, g, build, deploy]
    runs-on: ubuntu-latest
    steps:
    - run: echo "🔎 Le pipeline se termine ici"